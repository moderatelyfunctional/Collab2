{% extends 'base.html' %}
{% load static %}

{% block title %}
{{ user_type }} | Collab2
{% endblock %}

{% block contentCSS %}
<link type="text/css" rel="stylesheet" href="{% static 'css/space.css' %}" media="screen,projection"/>
<link type="text/css" rel="stylesheet" href="{% static 'vendor/codemirror/lib/codemirror.css' %}" media="screen,projection"/>
<link type="text/css" rel="stylesheet" href="{% static 'vendor/codemirror/theme/material.css' %}" media="screen,projection"/>
<link type="text/css" rel="stylesheet" href="{% static 'vendor/codemirror/addon/scroll/simplescrollbars.css' %}" media="screen,projection"/>
{% endblock %}

{% block headerJS %}
<script src="{% static 'vendor/codemirror/lib/codemirror.js' %}"></script>
<script src="{% static 'vendor/codemirror/mode/python/python.js' %}"></script>
<script src="{% static 'vendor/codemirror/addon/selection/active-line.js' %}"></script>
<script src="{% static 'vendor/codemirror/addon/scroll/simplescrollbars.js' %}"></script>
{% endblock %}

{% block header %}
<nav class="topbar">
	<div class="nav-wrapper">
		<div class="container">
			<a href="#" class="brand-logo">Collab2</a>
			<ul id="nav-mobile" class="right hide-on-med-and-down">
        {% if request.user.is_authenticated %}
        <li><a href="/logout/">Log Out</a></li>
        {% else %}
        <li><a href="/login/">Log In</a></li>
        {% endif %}
			</ul>
		</div>
	</div>
</nav>
{% endblock %}

{% block content %}
<div class="buffer">
	<form>
		<textarea id="codepython" name="codepython">{{ space_code }}</textarea>
	</form>

	<button id="run-btn" class="btn waves-effect waves-light" type="submit" name="action">Run
	  <i class="material-icons right">send</i>
	</button>
	<button id="push-btn" class="btn waves-effect waves-light" type="submit" name="action">Push
	  <i class="material-icons right">cloud</i>
	</button>

	{% if user_type == 'host' %}
		<form action="/delete_space/" method="post">
			<input type="hidden" name="space_url" value="{{ space_url }}" required>
			{% if error_text %}
				<div id="error-text">{{ error_text }}</div>
			{% endif %}
			<button class="btn waves-effect waves-light">Delete <i class="material-icons right">clear</i></button>

			{% csrf_token %}
		</form>
	{% endif %}
</div>
{% endblock %}

{% block contentJS %}

<script>
const editor = CodeMirror.fromTextArea(document.getElementById("codepython"), {
	mode: "python",
	theme: "material",
	scrollbarStyle: "overlay",
	styleActiveLine: true,
	lineNumbers: true,
	lineWrapping: true,
})
editor.setSize(null, 500);
const space_url = '{{ space_url }}';
</script>

{% if user_type == 'host' %}
	<script type="text/javascript" src="/static/colpy/javascript/space_host.js"></script>
{% else %}
	<script type="text/javascript" src="/static/colpy/javascript/space_participant.js"></script>
{% endif %}

{% endblock %}
